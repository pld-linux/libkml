--- libkml-1.2.0.orig/examples/engine/Makefile.am	2012-01-16 21:24:24.743866045 +0100
+++ libkml-1.2.0/examples/engine/Makefile.am	2012-01-17 16:37:35.359516135 +0100
@@ -1,5 +1,4 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/third_party/boost_1_34_1
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -ansi -pedantic -fno-rtti
--- libkml-1.2.0.orig/examples/gpx/Makefile.am	2012-01-16 21:24:24.737199379 +0100
+++ libkml-1.2.0/examples/gpx/Makefile.am	2012-01-17 16:36:46.049514483 +0100
@@ -1,5 +1,4 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/third_party/boost_1_34_1
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -ansi -pedantic -fno-rtti
--- libkml-1.2.0.orig/examples/gx/Makefile.am	2012-01-16 21:24:24.740532712 +0100
+++ libkml-1.2.0/examples/gx/Makefile.am	2012-01-17 16:37:24.139515759 +0100
@@ -1,5 +1,4 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/third_party/boost_1_34_1
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -ansi -pedantic -fno-rtti
--- libkml-1.2.0.orig/examples/hellonet/Makefile.am	2012-01-16 21:24:24.737199379 +0100
+++ libkml-1.2.0/examples/hellonet/Makefile.am	2012-01-17 16:36:37.422847527 +0100
@@ -1,7 +1,6 @@
 if HAVE_CURL
 AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/examples/hellonet \
-	      -I$(top_srcdir)/third_party/boost_1_34_1
+	      -I$(top_srcdir)/examples/hellonet
 
 if GCC
 AM_CXXFLAGS = -Wall -ansi -pedantic -fno-rtti
--- libkml-1.2.0.orig/examples/helloworld/Makefile.am	2012-01-16 21:24:24.740532712 +0100
+++ libkml-1.2.0/examples/helloworld/Makefile.am	2012-01-17 16:37:15.879515482 +0100
@@ -1,6 +1,5 @@
 AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/examples/helloworld \
-	      -I$(top_srcdir)/third_party/boost_1_34_1
+	      -I$(top_srcdir)/examples/helloworld
 
 
 if GCC
@@ -10,7 +9,7 @@
 noinst_LTLIBRARIES = libhelloutil.la
 
 libhelloutil_la_SOURCES = print.cc
-libhelloutil_la_LIBADD = $(top_builddir)/third_party/libminizip.la
+libhelloutil_la_LIBADD = $(top_builddir)/third_party/libkmlminizip.la
 
 noinst_PROGRAMS = countkml createkml checklinks circlegen helloattrs helloenum \
                   hellofeatures hellofolder hellogeometry hellohref hellokmz \
--- libkml-1.2.0.orig/examples/regionator/Makefile.am	2012-01-16 21:24:24.733866045 +0100
+++ libkml-1.2.0/examples/regionator/Makefile.am	2012-01-17 16:36:26.522847163 +0100
@@ -1,6 +1,4 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-              -I$(top_srcdir)/third_party/boost_1_34_1 \
-              -I$(top_srcdir)/third_party/zlib-1.2.3/contrib
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -ansi -pedantic -fno-rtti
--- libkml-1.2.0.orig/examples/xsd/Makefile.am	2012-01-16 21:24:24.740532712 +0100
+++ libkml-1.2.0/examples/xsd/Makefile.am	2012-01-17 16:37:00.232848292 +0100
@@ -1,6 +1,5 @@
 AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/examples/xsd \
-	      -I$(top_srcdir)/third_party/boost_1_34_1
+	      -I$(top_srcdir)/examples/xsd
 
 if GCC
 AM_CXXFLAGS = -Wall -ansi -pedantic -fno-rtti
--- libkml-1.2.0.orig/src/kml/base/Makefile.am	2012-01-16 21:24:24.750532711 +0100
+++ libkml-1.2.0/src/kml/base/Makefile.am	2012-01-17 16:27:14.232828670 +0100
@@ -1,7 +1,4 @@
 AM_CPPFLAGS = -I$(top_srcdir)/src \
-              -I$(top_srcdir)/third_party/boost_1_34_1 \
-              -I$(top_srcdir)/third_party/googletest-r108/include \
-              -I$(top_srcdir)/third_party/uriparser-0.7.5/include \
               -I$(top_srcdir)/third_party/zlib-1.2.3/contrib
 
 if GCC
@@ -31,8 +28,8 @@
 	zip_file.cc
 
 libkmlbase_la_LIBADD = \
-	$(top_builddir)/third_party/libminizip.la \
-	$(top_builddir)/third_party/liburiparser.la
+	$(top_builddir)/third_party/libkmlminizip.la \
+	-luriparser
 
 # These header files will be installed in $(includedir)/kml/base
 libkmlbaseincludedir = $(includedir)/kml/base
@@ -97,116 +94,93 @@
 
 attributes_test_SOURCES = attributes_test.cc
 attributes_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-attributes_test_LDADD = libkmlbase.la \
-			$(top_builddir)/third_party/libgtest.la
+attributes_test_LDADD = libkmlbase.la -lgtest
 
 color32_test_SOURCES = color32_test.cc
 color32_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-color32_test_LDADD = libkmlbase.la \
-		     $(top_builddir)/third_party/libgtest.la
+color32_test_LDADD = libkmlbase.la -lgtest
 
 csv_splitter_test_SOURCES = csv_splitter_test.cc
 csv_splitter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
-csv_splitter_test_LDADD = libkmlbase.la \
-			$(top_builddir)/third_party/libgtest.la
+csv_splitter_test_LDADD = libkmlbase.la -lgtest
 
 date_time_test_SOURCES = date_time_test.cc
 date_time_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-date_time_test_LDADD = libkmlbase.la \
-		       $(top_builddir)/third_party/libgtest.la
+date_time_test_LDADD = libkmlbase.la -lgtest
 
 expat_handler_ns_test_SOURCES = expat_handler_ns_test.cc
 expat_handler_ns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-expat_handler_ns_test_LDADD = libkmlbase.la \
-			      $(top_builddir)/third_party/libgtest.la
+expat_handler_ns_test_LDADD = libkmlbase.la -lgtest
 
 expat_parser_test_SOURCES = expat_parser_test.cc
 expat_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
-expat_parser_test_LDADD = libkmlbase.la \
-			      $(top_builddir)/third_party/libgtest.la
+expat_parser_test_LDADD = libkmlbase.la -lgtest
 
 file_test_SOURCES = file_test.cc
 file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
-file_test_LDADD = libkmlbase.la \
-		  $(top_builddir)/third_party/libgtest.la
+file_test_LDADD = libkmlbase.la -lgtest
 
 math_util_test_SOURCES = math_util_test.cc
 math_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-math_util_test_LDADD = libkmlbase.la \
-		  $(top_builddir)/third_party/libgtest.la
+math_util_test_LDADD = libkmlbase.la -lgtest
 
 net_cache_test_SOURCES = net_cache_test.cc
 net_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
-net_cache_test_LDADD = libkmlbase.la \
-        $(top_builddir)/third_party/liburiparser.la \
-	$(top_builddir)/third_party/libgtest.la
+net_cache_test_LDADD = libkmlbase.la -luriparser -lgtest
 
 referent_test_SOURCES = referent_test.cc
 referent_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-referent_test_LDADD= libkmlbase.la \
-		     $(top_builddir)/third_party/libgtest.la
+referent_test_LDADD= libkmlbase.la -lgtest
 
 string_util_test_SOURCES = string_util_test.cc
 string_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-string_util_test_LDADD= libkmlbase.la \
-			$(top_builddir)/third_party/libgtest.la
+string_util_test_LDADD= libkmlbase.la -lgtest
 
 tempfile_test_SOURCES = tempfile_test.cc
 tempfile_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
-tempfile_test_LDADD = libkmlbase.la \
-		      $(top_builddir)/third_party/libgtest.la
+tempfile_test_LDADD = libkmlbase.la -lgtest
 
 time_util_test_SOURCES = time_util_test.cc
 time_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-time_util_test_LDADD= libkmlbase.la \
-		      $(top_builddir)/third_party/libgtest.la
+time_util_test_LDADD= libkmlbase.la -lgtest
 
 uri_parser_test_SOURCES = uri_parser_test.cc
 uri_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
-uri_parser_test_LDADD= libkmlbase.la \
-        $(top_builddir)/third_party/liburiparser.la \
-	$(top_builddir)/third_party/libgtest.la
+uri_parser_test_LDADD= libkmlbase.la -luriparser -lgtest
 
 util_test_SOURCES = util_test.cc
 util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-util_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libgtest.la
+util_test_LDADD= libkmlbase.la -lgtest
 
 vec3_test_SOURCES = vec3_test.cc
 vec3_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-vec3_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libgtest.la
+vec3_test_LDADD= libkmlbase.la -lgtest
 
 version_test_SOURCES = version_test.cc
 version_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-version_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libgtest.la
+version_test_LDADD= libkmlbase.la -lgtest
 
 xml_element_test_SOURCES = xml_element_test.cc
 xml_element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-xml_element_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libgtest.la
+xml_element_test_LDADD= libkmlbase.la -lgtest
 
 xml_file_test_SOURCES = xml_file_test.cc
 xml_file_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-xml_file_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libgtest.la
+xml_file_test_LDADD= libkmlbase.la -lgtest
 
 xml_namespaces_test_SOURCES = xml_namespaces_test.cc
 xml_namespaces_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-xml_namespaces_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libgtest.la
+xml_namespaces_test_LDADD= libkmlbase.la -lgtest
 
 xmlns_test_SOURCES = xmlns_test.cc
 xmlns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
-xmlns_test_LDADD= libkmlbase.la \
-		  $(top_builddir)/third_party/libgtest.la
+xmlns_test_LDADD= libkmlbase.la -lgtest
 
 zip_file_test_SOURCES = zip_file_test.cc
 zip_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 zip_file_test_LDADD= libkmlbase.la \
-		 $(top_builddir)/third_party/libminizip.la \
-		 $(top_builddir)/third_party/libgtest.la
+		 $(top_builddir)/third_party/libkmlminizip.la \
+		 -lgtest
 
 CLEANFILES = check_PROGRAMS
 
--- libkml-1.2.0.orig/src/kml/convenience/Makefile.am	2012-01-16 21:24:24.757199378 +0100
+++ libkml-1.2.0/src/kml/convenience/Makefile.am	2012-01-17 16:28:26.796164433 +0100
@@ -1,6 +1,4 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/third_party/boost_1_34_1 \
-              -I$(top_srcdir)/third_party/googletest-r108/include
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -ansi -pedantic -fno-rtti
@@ -66,7 +64,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 convenience_test_SOURCES = convenience_test.cc
 convenience_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
@@ -74,7 +72,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 csv_file_test_SOURCES = csv_file_test.cc
 csv_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -82,7 +80,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 csv_parser_test_SOURCES = csv_parser_test.cc
 csv_parser_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -90,7 +88,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 element_counter_test_SOURCES = element_counter_test.cc
 element_counter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -98,7 +96,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 feature_list_test_SOURCES = feature_list_test.cc
 feature_list_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
@@ -106,7 +104,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 google_doc_list_test_SOURCES = google_doc_list_test.cc
 google_doc_list_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -114,7 +112,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 google_maps_data_test_SOURCES = google_maps_data_test.cc
 google_maps_data_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -122,7 +120,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 google_picasa_web_test_SOURCES = google_picasa_web_test.cc
 google_picasa_web_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -130,7 +128,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 google_spreadsheets_test_SOURCES = google_spreadsheets_test.cc
 google_spreadsheets_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -138,7 +136,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 gpx_trk_pt_handler_test_SOURCES = gpx_trk_pt_handler_test.cc
 gpx_trk_pt_handler_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -146,13 +144,13 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 http_client_test_SOURCES = http_client_test.cc
 http_client_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 http_client_test_LDADD = http_client.o \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kmz_check_links_test_SOURCES = kmz_check_links_test.cc
 kmz_check_links_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
@@ -160,6 +158,6 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 CLEANFILES = check_PROGRAMS
--- libkml-1.2.0.orig/src/kml/dom/Makefile.am	2012-01-16 21:24:24.747199378 +0100
+++ libkml-1.2.0/src/kml/dom/Makefile.am	2012-01-17 16:33:18.899507548 +0100
@@ -1,6 +1,4 @@
-AM_CPPFLAGS= -I$(top_srcdir)/src \
-	     -I$(top_srcdir)/third_party/boost_1_34_1 \
-	     -I$(top_srcdir)/third_party/googletest-r108/include
+AM_CPPFLAGS= -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -ansi -pedantic -fno-rtti
@@ -180,306 +178,306 @@
 abstractlatlonbox_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 abstractlatlonbox_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 abstractview_test_SOURCES = abstractview_test.cc
 abstractview_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 abstractview_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 atom_test_SOURCES = atom_test.cc
 atom_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 atom_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 balloonstyle_test_SOURCES = balloonstyle_test.cc
 balloonstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 balloonstyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 colorstyle_test_SOURCES = colorstyle_test.cc
 colorstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 colorstyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 container_test_SOURCES = container_test.cc
 container_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 container_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 document_test_SOURCES = document_test.cc
 document_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 document_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 element_test_SOURCES = element_test.cc
 element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 element_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 extendeddata_test_SOURCES = extendeddata_test.cc
 extendeddata_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 extendeddata_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 feature_test_SOURCES = feature_test.cc
 feature_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 feature_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 folder_test_SOURCES = folder_test.cc
 folder_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 folder_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 geometry_test_SOURCES = geometry_test.cc
 geometry_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 geometry_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 hotspot_test_SOURCES = hotspot_test.cc
 hotspot_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 hotspot_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 iconstyle_test_SOURCES = iconstyle_test.cc
 iconstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 iconstyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_cast_test_SOURCES = kml_cast_test.cc
 kml_cast_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 kml_cast_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_test_SOURCES = kml_test.cc
 kml_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 kml_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_factory_test_SOURCES = kml_factory_test.cc
 kml_factory_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 kml_factory_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml22_test_SOURCES = kml22_test.cc
 kml22_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 kml22_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 labelstyle_test_SOURCES = labelstyle_test.cc
 labelstyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 labelstyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 linestyle_test_SOURCES = linestyle_test.cc
 linestyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 linestyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 link_test_SOURCES = link_test.cc
 link_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 link_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 liststyle_test_SOURCES = liststyle_test.cc
 liststyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 liststyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 model_test_SOURCES = model_test.cc
 model_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 model_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 networklink_test_SOURCES = networklink_test.cc
 networklink_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 networklink_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 networklinkcontrol_test_SOURCES = networklinkcontrol_test.cc
 networklinkcontrol_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 networklinkcontrol_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 object_test_SOURCES = object_test.cc
 object_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 object_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 overlay_test_SOURCES = overlay_test.cc
 overlay_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 overlay_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 placemark_test_SOURCES = placemark_test.cc
 placemark_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 placemark_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 polystyle_test_SOURCES = polystyle_test.cc
 polystyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 polystyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 region_test_SOURCES = region_test.cc
 region_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 region_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 round_trip_test_SOURCES = round_trip_test.cc
 round_trip_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 round_trip_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 schema_test_SOURCES = schema_test.cc
 schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 schema_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 snippet_test_SOURCES = snippet_test.cc
 snippet_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 snippet_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 style_test_SOURCES = style_test.cc
 style_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 style_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 stylemap_test_SOURCES = stylemap_test.cc
 stylemap_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 stylemap_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 styleselector_test_SOURCES = styleselector_test.cc
 styleselector_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 styleselector_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 substyle_test_SOURCES = substyle_test.cc
 substyle_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 substyle_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 timeprimitive_test_SOURCES = timeprimitive_test.cc
 timeprimitive_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 timeprimitive_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 gx_timeprimitive_test_SOURCES = gx_timeprimitive_test.cc
 gx_timeprimitive_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 gx_timeprimitive_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 gx_tour_test_SOURCES = gx_tour_test.cc
 gx_tour_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 gx_tour_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 vec2_test_SOURCES = vec2_test.cc
 vec2_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 vec2_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 unknown_test_SOURCES = unknown_test.cc
 unknown_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 unknown_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_handler_test_SOURCES = kml_handler_test.cc
 kml_handler_test_CXXFLAGS =  -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kml_handler_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_handler_ns_test_SOURCES = kml_handler_ns_test.cc
 kml_handler_ns_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 kml_handler_ns_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 parser_test_SOURCES = parser_test.cc
 parser_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 parser_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 serializer_test_SOURCES = serializer_test.cc
 serializer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 serializer_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xal_test_SOURCES = xal_test.cc
 xal_test_CXXFLAGS =  -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 xal_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xml_serializer_test_SOURCES = xml_serializer_test.cc
 xml_serializer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xml_serializer_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_test_SOURCES = xsd_test.cc
 xsd_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 visitor_test_SOURCES = visitor_test.cc
 visitor_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 visitor_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 visitor_driver_test_SOURCES = visitor_driver_test.cc
 visitor_driver_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 visitor_driver_test_LDADD= libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 CLEANFILES = check_PROGRAMS
--- libkml-1.2.0.orig/src/kml/engine/Makefile.am	2012-01-16 21:24:24.760532712 +0100
+++ libkml-1.2.0/src/kml/engine/Makefile.am	2012-01-17 16:35:33.619512058 +0100
@@ -1,6 +1,4 @@
-AM_CPPFLAGS= -I$(top_srcdir)/src \
-	     -I$(top_srcdir)/third_party/boost_1_34_1 \
-	     -I$(top_srcdir)/third_party/googletest-r108/include
+AM_CPPFLAGS= -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -ansi -pedantic -fno-rtti
@@ -129,224 +127,224 @@
 bbox_test_LDADD = libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 clone_test_SOURCES = clone_test.cc
 clone_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 clone_test_LDADD = libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 entity_mapper_test_SOURCES = entity_mapper_test.cc
 entity_mapper_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 entity_mapper_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 feature_balloon_test_SOURCES = feature_balloon_test.cc
 feature_balloon_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 feature_balloon_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 feature_view_test_SOURCES = feature_view_test.cc
 feature_view_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 feature_view_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 feature_visitor_test_SOURCES = feature_visitor_test.cc
 feature_visitor_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 feature_visitor_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 find_test_SOURCES = find_test.cc
 find_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 find_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 get_link_parents_test_SOURCES = get_link_parents_test.cc
 get_link_parents_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 get_link_parents_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 get_links_test_SOURCES = get_links_test.cc
 get_links_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 get_links_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 href_test_SOURCES = href_test.cc
 href_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 href_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 id_mapper_test_SOURCES = id_mapper_test.cc
 id_mapper_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 id_mapper_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_cache_test_SOURCES = kml_cache_test.cc
 kml_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kml_cache_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_file_test_SOURCES = kml_file_test.cc
 kml_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kml_file_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_stream_test_SOURCES = kml_stream_test.cc
 kml_stream_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kml_stream_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kml_uri_test_SOURCES = kml_uri_test.cc
 kml_uri_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kml_uri_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kmz_cache_test_SOURCES = kmz_cache_test.cc
 kmz_cache_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kmz_cache_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 kmz_file_test_SOURCES = kmz_file_test.cc
 kmz_file_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 kmz_file_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 link_util_test_SOURCES = link_util_test.cc
 link_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 link_util_test_LDADD = libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 location_util_test_SOURCES = location_util_test.cc
 location_util_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 location_util_test_LDADD = libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 merge_test_SOURCES = merge_test.cc
 merge_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 merge_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 object_id_parser_observer_test_SOURCES = object_id_parser_observer_test.cc
 object_id_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 object_id_parser_observer_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 old_schema_parser_observer_test_SOURCES = old_schema_parser_observer_test.cc
 old_schema_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 old_schema_parser_observer_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 parse_old_schema_test_SOURCES = parse_old_schema_test.cc
 parse_old_schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 parse_old_schema_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 schema_parser_observer_test_SOURCES = schema_parser_observer_test.cc
 schema_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 schema_parser_observer_test_LDADD= \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 shared_style_parser_observer_test_SOURCES = shared_style_parser_observer_test.cc
 shared_style_parser_observer_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 shared_style_parser_observer_test_LDADD= \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 style_inliner_test_SOURCES = style_inliner_test.cc
 style_inliner_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 style_inliner_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/liburiparser.la \
-	$(top_builddir)/third_party/libgtest.la
+	-luriparser \
+	-lgtest
 
 style_merger_test_SOURCES = style_merger_test.cc
 style_merger_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 style_merger_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 style_resolver_test_SOURCES = style_resolver_test.cc
 style_resolver_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 style_resolver_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 style_splitter_test_SOURCES = style_splitter_test.cc
 style_splitter_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 style_splitter_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 update_processor_test_SOURCES = update_processor_test.cc
 update_processor_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 update_processor_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 update_test_SOURCES = update_test.cc
 update_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 update_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 find_xml_namespaces_test_SOURCES = find_xml_namespaces_test.cc
 find_xml_namespaces_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 find_xml_namespaces_test_LDADD= libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 CLEANFILES = check_PROGRAMS
--- libkml-1.2.0.orig/src/kml/regionator/Makefile.am	2012-01-16 21:24:24.750532711 +0100
+++ libkml-1.2.0/src/kml/regionator/Makefile.am	2012-01-17 16:35:02.576177685 +0100
@@ -1,6 +1,4 @@
-AM_CPPFLAGS= -I$(top_srcdir)/src \
-             -I$(top_srcdir)/third_party/boost_1_34_1 \
-	     -I$(top_srcdir)/third_party/googletest-r108/include
+AM_CPPFLAGS= -I$(top_srcdir)/src
 
 
 if GCC
@@ -38,7 +36,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 regionator_test_SOURCES = regionator_test.cc
 regionator_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
@@ -47,7 +45,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 regionator_qid_test_SOURCES = regionator_qid_test.cc
 regionator_qid_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
@@ -56,7 +54,7 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 regionator_util_test_SOURCES = regionator_util_test.cc
 regionator_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
@@ -65,6 +63,6 @@
 	$(top_builddir)/src/kml/engine/libkmlengine.la \
 	$(top_builddir)/src/kml/dom/libkmldom.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 CLEANFILES = check_PROGRAMS
--- libkml-1.2.0.orig/src/kml/xsd/Makefile.am	2012-01-16 21:24:24.753866044 +0100
+++ libkml-1.2.0/src/kml/xsd/Makefile.am	2012-01-17 16:36:07.992846541 +0100
@@ -1,6 +1,4 @@
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-              -I$(top_srcdir)/third_party/boost_1_34_1 \
-	      -I$(top_srcdir)/third_party/googletest-r108/include
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 if GCC
 AM_CXXFLAGS = -Wall -Wextra -Wno-unused-parameter -ansi -pedantic -fno-rtti
@@ -49,54 +47,54 @@
 xsd_complex_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_complex_type_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_file_test_SOURCES = xsd_file_test.cc
 xsd_file_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_file_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_element_test_SOURCES = xsd_element_test.cc
 xsd_element_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_element_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_handler_test_SOURCES = xsd_handler_test.cc
 xsd_handler_test_CXXFLAGS = -DDATADIR=\"$(DATA_DIR)\" $(AM_TEST_CXXFLAGS)
 xsd_handler_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_primitive_type_test_SOURCES = xsd_primitive_type_test.cc
 xsd_primitive_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_primitive_type_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_schema_test_SOURCES = xsd_schema_test.cc
 xsd_schema_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_schema_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_simple_type_test_SOURCES = xsd_simple_type_test.cc
 xsd_simple_type_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_simple_type_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xsd_util_test_SOURCES = xsd_util_test.cc
 xsd_util_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xsd_util_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 xst_parser_test_SOURCES = xst_parser_test.cc
 xst_parser_test_CXXFLAGS = $(AM_TEST_CXXFLAGS)
 xst_parser_test_LDADD = libkmlxsd.la \
 	$(top_builddir)/src/kml/base/libkmlbase.la \
-	$(top_builddir)/third_party/libgtest.la
+	-lgtest
 
 CLEANFILES = check_PROGRAMS
--- libkml-1.2.0.orig/src/swig/Makefile.am	2010-01-14 01:16:31.000000000 +0100
+++ libkml-1.2.0/src/swig/Makefile.am	2012-01-17 16:24:10.812822528 +0100
@@ -1,8 +1,6 @@
 SUBDIRS = java python
 
-AM_CPPFLAGS = -I$(top_srcdir)/src \
-	      -I$(top_srcdir)/third_party/boost_1_34_1 \
-	      -I$(top_srcdir)/third_party/uriparser-0.7.5/include
+AM_CPPFLAGS = -I$(top_srcdir)/src
 
 COMMONLIBS = $(top_builddir)/src/kml/engine/libkmlengine.la \
              $(top_builddir)/src/kml/dom/libkmldom.la \
--- libkml-1.2.0/third_party/Makefile.am.orig	2010-02-18 21:07:01.000000000 +0100
+++ libkml-1.2.0/third_party/Makefile.am	2012-01-18 17:25:38.089172314 +0100
@@ -1,92 +1,18 @@
 uriparser = uriparser-0.7.5
 
-AM_CPPFLAGS = -I$(top_srcdir)/third_party/zlib-1.2.3/contrib \
-	      -I$(top_srcdir)/third_party/$(uriparser)/include \
-	      -I$(top_srcdir)/third_party/googletest-r108 \
-	      -I$(top_srcdir)/third_party/googletest-r108/include
+AM_CPPFLAGS = -I$(top_srcdir)/third_party/zlib-1.2.3/contrib
 
-lib_LTLIBRARIES = libminizip.la liburiparser.la
-noinst_LTLIBRARIES = libgtest.la
+lib_LTLIBRARIES = libkmlminizip.la
 
-libminizip_la_SOURCES = \
+libkmlminizip_la_SOURCES = \
 	zlib-1.2.3/contrib/minizip/unzip.c \
 	zlib-1.2.3/contrib/minizip/ioapi.c \
 	zlib-1.2.3/contrib/minizip/iomem_simple.c \
 	zlib-1.2.3/contrib/minizip/zip.c
-libminizip_la_LDFLAGS = -lz
-
-liburiparser_la_SOURCES = \
-	$(uriparser)/lib/UriCommon.c \
-	$(uriparser)/lib/UriCommon.h \
-	$(uriparser)/lib/UriCompare.c \
-	$(uriparser)/lib/UriEscape.c \
-	$(uriparser)/lib/UriFile.c \
-	$(uriparser)/lib/UriIp4.c \
-	$(uriparser)/lib/UriIp4Base.c \
-	$(uriparser)/lib/UriIp4Base.h \
-	$(uriparser)/lib/UriNormalize.c \
-	$(uriparser)/lib/UriNormalizeBase.c \
-	$(uriparser)/lib/UriNormalizeBase.h \
-	$(uriparser)/lib/UriParse.c \
-	$(uriparser)/lib/UriParseBase.c \
-	$(uriparser)/lib/UriParseBase.h \
-	$(uriparser)/lib/UriQuery.c \
-	$(uriparser)/lib/UriRecompose.c \
-	$(uriparser)/lib/UriResolve.c \
-	$(uriparser)/lib/UriShorten.c
-liburiparser_la_LDFLAGS = -version-info 1:5:0
+libkmlminizip_la_LDFLAGS = -lz
 
 boost_root = boost_1_34_1
 boost = $(boost_root)/boost
-boostinc = $(includedir)/kml/third_party/$(boost)
-libboostincludedir = $(boostinc)
-libboostinclude_HEADERS = \
-	${boost}/assert.hpp \
-	${boost}/checked_delete.hpp \
-	${boost}/config.hpp \
-	${boost}/intrusive_ptr.hpp \
-	${boost}/scoped_ptr.hpp
-
-libboostdetailincludedir = $(boostinc)/detail
-libboostdetailinclude_HEADERS = \
-	$(boost)/detail/workaround.hpp
-
-libboostconfigincludedir = $(boostinc)/config
-libboostconfiginclude_HEADERS = \
-	$(boost)/config/posix_features.hpp \
-	$(boost)/config/select_compiler_config.hpp \
-	$(boost)/config/select_stdlib_config.hpp \
-	$(boost)/config/select_platform_config.hpp \
-	$(boost)/config/suffix.hpp \
-	$(boost)/config/user.hpp
-
-libboostconfigcompilerincludedir = $(boostinc)/config/compiler
-libboostconfigcompilerinclude_HEADERS = \
-	$(boost)/config/compiler/gcc.hpp
-	
-libboostconfigno_tr1includedir = $(boostinc)/config/no_tr1
-libboostconfigno_tr1include_HEADERS = \
-	$(boost)/config/no_tr1/utility.hpp
-	
-libboostconfigstdlibincludedir = $(boostinc)/config/stdlib
-libboostconfigstdlibinclude_HEADERS = \
-	$(boost)/config/stdlib/libstdcpp3.hpp
-
-libboostconfigplatformincludedir = $(boostinc)/config/platform
-libboostconfigplatforminclude_HEADERS = \
-	$(boost)/config/platform/linux.hpp \
-	$(boost)/config/platform/macos.hpp
-
-googletest = googletest-r108
-libgtest_la_SOURCES = \
-	$(googletest)/src/gtest.cc \
-	$(googletest)/src/gtest-death-test.cc \
-	$(googletest)/src/gtest-filepath.cc \
-	$(googletest)/src/gtest-internal-inl.h \
-	$(googletest)/src/gtest-port.cc \
-	$(googletest)/src/gtest-test-part.cc \
-	$(googletest)/src/gtest-typed-test.cc
-
 EXTRA_DIST = \
 	expat.win32/expat.h \
 	expat.win32/expat_external.h \
